<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>boba.vim - Multiplayer Game</title>
    <link
      rel="icon"
      type="image/png"
      href="/static/sprites/logo/boba_vim_banner.png"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/static/css/global.css" />
    <link rel="stylesheet" href="/static/css/game.css" />
    <link rel="stylesheet" href="/static/css/multiplayer.css" />
  </head>
  <body class="multiplayer-game-page">
    <!-- Animated clouds background -->
    <div class="clouds-container" id="clouds-background"></div>

    <div class="game-container">
      {{template "multiplayer_game_header" .}} 
      {{template "multiplayer_game_board" .}} 
      {{template "multiplayer_game_debug_info" .}} 
    </div>

    <!-- Game music button - bottom right -->
    <div class="game-music-button">
      <picture>
        <source srcset="/static/sprites/avatar/uncle_song.webp" type="image/webp">
        <img
          src="/static/sprites/avatar/uncle_song.png"
          alt="Music Control"
          id="gameMusicButton"
          class="music-icon"
          title="Play/Stop Music"
        />
      </picture>
      <div class="stop-overlay" id="gameStopOverlay">‚è∏</div>
    </div>

    <!-- Game background music -->
    <audio id="gameBackgroundMusic" loop>
      <source src="/static/music/multiplayer/multiplayer_boba.mp3" type="audio/mpeg" />
      Your browser does not support the audio element.
    </audio>

    <script>
      // Set multiplayer variables BEFORE loading any modules
      window.MULTIPLAYER_MATCH_ID = "{{.match_id}}";
      window.IS_MULTIPLAYER = true;
      console.log("Multiplayer mode set:", window.IS_MULTIPLAYER);
    </script>
    
    {{template "multiplayer_game_scripts" .}}
  </body>
</html>